<div class="actividad-container" *ngIf="palabraActual">
    <header class="actividad-header">
        <button (click)="regresar()" class="back-button">
            <i class="fa-solid fa-arrow-left"></i>
        </button>
        <div class="progress-area">
            <span class="progress-title">
                Progreso: {{progressData?.palabraActual || 0}} de {{progressData?.totalPalabras || 0}} palabras 
                ({{progreso.toFixed(0)}}%)
            </span>
            <div class="progress-bar-container">
                <div 
                    class="progress-bar-fill" 
                    [style.width.%]="progreso"
                    [style.background-color]="obtenerColorBarra()"
                >
                </div> 
            </div>
            <span class="progress-subtitle" *ngIf="progressData">
                Completadas: {{progressData.palabrasCompletadas}} | 
                Faltantes: {{progressData.palabrasFaltantes}}
            </span>
        </div>
    </header>

    <div class="content-area">
        <div class="image-navigation">
            <button 
                class="nav-arrow left-arrow"
                (click)="anteriorPalabra()"
                [disabled]="!puedeIrAnterior()"
                [class.disabled]="!puedeIrAnterior()"
                [title]="puedeIrAnterior() ? 'Palabra anterior' : 'Esta es la primera palabra'"
            >
                <i class="fa-solid fa-arrow-left"></i>
            </button>
            
            <div class="main-image-card" [style.background-color]="navigationService.obtenerColorAleatorio()">
                <img [src]="palabraActual.imagenUrl" [alt]="palabraActual.palabra" class="main-image">
            </div>
            
            <button 
                class="nav-arrow right-arrow"
                (click)="siguientePalabra()"
                [disabled]="!puedeirSiguiente()"
                [class.disabled]="!puedeirSiguiente()"
                [title]="puedeirSiguiente() ? 'Siguiente palabra' : 'Esta es la última palabra'"
            >
                <i class="fa-solid fa-arrow-right"></i>
            </button>
        </div>

        <div class="syllable-buttons">
            <button 
                *ngFor="let silaba of palabraActual.silabas; let i = index"
                class="syllable-button"
                [ngClass]="obtenerColorSilaba(i)"
            >
                {{silaba.texto}}
            </button>
            <button class="audio-button" title="Reproducir audio (próximamente)">
                <i class="fa-solid fa-volume-high"></i>
            </button>
        </div>

        <div class="phoneme-buttons">
            <button 
                *ngFor="let fonema of palabraActual.fonemas; let i = index"
                class="phoneme-button"
                [ngClass]="obtenerColorFonema(i)"
            >
                {{fonema.texto}}
            </button>
        </div>

        <div class="palabra-info">
            <p class="palabra-completa">{{palabraActual.palabra}}</p>
            <p class="palabra-contador">
                {{obtenerTextoProgreso()}}
                <span *ngIf="actividadCompletada()" class="completado-badge">
                    <i class="fa-solid fa-check-circle"></i> ¡Completado!
                </span>
            </p>
        </div>
    </div>
</div>

<div class="no-data" *ngIf="!palabraActual">
    <i class="fa-solid fa-exclamation-triangle"></i>
    <h3>No hay datos disponibles</h3>
    <p>No se pudo cargar la actividad</p>
    <button (click)="regresar()" class="btn-regresar">Volver</button>
</div>